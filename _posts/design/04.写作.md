# 分类
## 日记随笔
通过微信收集的信息
## 素材上传
可以上传和使用以下内容：
1. img - 图片,png,jpg,gif
2. file - 语音mp3,视频mp4,zip,文档word和excel
3. css - 样式
4. js - 脚本
## 文章
通过后台管理界面或官方客户端创建的文章。

# 创建日记
## 用例描述
微信粉丝用户通过微信客户端创建日记
## 业务规则
1. 将用户每天在微信公众号中的输入归档为日记
2. 用户的输入可以是文字，图片，语音和视频
3. 语音可以自动转化为文字

## 前置条件
1. 关注微信公众号
2. 完成信息绑定
3. 微信公众号必须已经认证
4. 只有当前关注微信公众号的用户可以接收生成的日志

## 主要流程
1. 首先点击微信公众号中的“日记”菜单,
1. 然后输入文字，语音或上传图片和视频。
1. 系统用户输入，并在当天10点左右生成当天日志。
1. 最后用户接收到当天日志。

## 分支流程
### 粉丝绑定
如果粉丝没有绑定用户信息，提示用户绑定信息。系统会发送一个绑定信息的页面链接。
### 素材上传
图片和视频需要保存在用户的素材库中。
## 后置条件
1. 所有粉丝输入都记录在mongodb中
2. 当天的输入正确生成相应的文章
## 交互说明
1. 新关注公众号的粉丝，如果没有绑定信息将接收到信息绑定单图文消息。
2. 粉丝点击“日志”菜单项，如果没有绑定信息将接收到信息绑定单图文消息。
3. 粉丝在公众号中发送任何内容，如果没有绑定信息将接收到信息绑定单图文消息。
## 输入输出
### 输入
粉丝在微信公众号的所有输入内容，语音将直接转为文字。
### 输出
1. 粉丝文字输入将记录在mongodb中
2. 粉丝语音输入将转为文字记录在mongodb中
3. 粉丝上传的文件将存储在用户所在目录的file目录中，并在mongodb中记录相应引用的html文本记录在mongodb中
4. 最终生成的日志的内容以*.md的形式存储在用户所在目录的source/dairy中。
## 其他补充
日志也是文章，后续可以编辑或删除。

# 创建文章
## 用例描述
所有用户创建一篇新文章
## 业务规则
1. 用户不需要关心文章的结构
2. 用户不需要知道太多的样式设置
3. 尽可能简单，不给用户多余的选择
## 前置条件
无
## 主要流程
首先选择一个系统模板（页面，随笔，新闻，文档），然后设置文章的相对路径，比如：/path/filename，编写文章的内容，然后发布文章。
## 分支流程
### 文章路径
文章的路径首先必须满足文件系统的命名规范，其次必须不存在。
### 文章内容
对特殊字符或内容需要过滤或特殊处理。
## 后置条件
1. 只在有网络的情况下发布成功
2. 
## 交互说明
## 输入输出
### 输入
无
### 输出
文章的内容以*.md的形式存储在用户所在目录中
## 其他补充


# 修改文章
## 用例描述
所有用户选择已经存在的文章进行编辑，修改。
## 业务规则
1. 修改文章的规则与创建文章的规则相同
2. 文章的路径不可以修改
## 前置条件
1. 必须是已经存在的文章
## 主要流程
选择一个已经存在的文章，可以选择其它系统中其它模板，可以编辑文章的内容，最后点击“保存”按钮，提交修改。
## 分支流程
无
## 后置条件
1. 用户的输入以.md文件保存
## 交互说明
1. 选择其它模板时，提示用户模板修改会使文章样式发生变化，是否需要继续操作。
1. 修改过文章没有保存就关闭时，提示用户当前文章没有保存是否确定放弃当前的编辑。
## 输入输出
### 输入
原文章的内容，包括页面内的设置读取。
### 输出
文章的内容以*.md的形式存储在用户所在目录中
## 其他补充
和删除文章一样，对文章中引用的素材，需要用户自己去删除。

# 上传素材
## 用例描述
用户上传图片，视频，语音，样式等文件。
## 业务规则
1. 在后台批量上传文件
2. 在微信公众号中上传文件
3. 不同类型的文件存储在相应用户目录
   1. img - 图片,png,jpg,gif
   2. file - 语音mp3,视频mp4,zip,文档word和excel
   3. css - 样式
   4. js - 脚本
4. 每个用户的素材内容不能超过1GB 
5. 素材库的容量足够

## 前置条件
1. 已经登录的用户
2. 上传的文件合法
## 主要流程
选择需要上传的文件，系统检查文件的合法性，上传文件内容，保存成功后，计算用户素材库的大小。
## 分支流程

## 后置条件
1. 文件保存在用户所在相应目录中

## 交互说明
选择其它模板时，提示用户模板修改会使文章样式发生变化，是否需要继续操作。
修改文章路径时，提示用户文章路径的修改会改变原导航的失效，需要用户重新生成新的导航，是否需要继续操作。
修改过文章没有保存就关闭时，提示用户当前文章没有保存是否确定放弃当前的编辑。
## 输入输出
### 输入
原文章的内容，包括页面内的设置读取。
### 输出
文章的内容以*.md的形式存储在用户所在目录中
## 其他补充
和删除文章一样，对文章中引用的素材，需要用户自己去删除。

