
# 添加好友
## 用例描述
所有用户输入或上传手机号或邮件列表，增加为自己的好友
## 业务规则
1. 输入手机号或电子邮件增加好友
2. 上传手机号和或电子邮件列表增加好友
3. 使用其它工具同步好友
4. 系统不存在的用户，发线下消息通知用户被添加为好友
5. 非用户好友，发线上消息通知用户被添加为好友
6. 已经是好友或多次重复添加，不做任何消息通知

## 前置条件
无

## 主要流程
1. 首先用户输入手机号或电子邮件，点击“添加”按钮，系统验证输入无误，记录添加好友操作。
2. 然后系统异步执行添加好友操作。
3. 同时通知用户添加操作已经成功，等待好友的确认。
4. 最后在好友确认添加好友申请后，用户接收到添加好友成功的通知。

## 分支流程

### 消息通知
所有操作请求和操作结果都会以消息的形式推送给相应的用户。消息通知分为：
1. 短信通知
2. 邮件通知
3. 站内消息通知

### 申请确认
1. 首先被申请用户接收到申请消息（含OpenId）,用户可以选择接受或拒绝
2. 如果接受，将会更新两个用户的好友清单。
## 后置条件
1. 所有输入的好友都记录在用户的好友列表中
2. 所有添加好友的申请都通知过相应好友
3. 只有申请确认过的用户才能成为沟通的好友，否则只是关注而已
## 交互说明
1. 新关注公众号的粉丝，如果没有绑定信息将接收到信息绑定单图文消息。
2. 粉丝点击“日志”菜单项，如果没有绑定信息将接收到信息绑定单图文消息。
3. 粉丝在公众号中发送任何内容，如果没有绑定信息将接收到信息绑定单图文消息。
## 输入输出
### 输入
粉丝在微信公众号的所有输入内容，语音将直接转为文字。
### 输出
1. 粉丝文字输入将记录在mongodb中
2. 粉丝语音输入将转为文字记录在mongodb中
3. 粉丝上传的文件将存储在用户所在目录的file目录中，并在mongodb中记录相应引用的html文本记录在mongodb中
4. 最终生成的日志的内容以*.md的形式存储在用户所在目录的source/dairy中。
## 其他补充
日志也是文章，后续可以编辑或删除。
